---
title: Exploiting "RootMe" on TryHackMe
author: tech0ne
date: 2025-08-14 11:00:00 +0100
categories: [walkthrough, tryhackme, easy]
comments: true
toc: true
pin: false
tags: [walkthrough, tryhackme, linux, web-exploitation, suid]
math: true
mermaid: true
---

# Introduction

Today, we'll look at our first TryHackMe room.

This is a really easy one, we'll use to learn a little about Web Exploitation, as well as Linux Enumeration.

It's called [RootMe](https://tryhackme.com/room/rrootme), but it's on TryHackMe (hehehe)

## Disclamer

> This is a COMPLETE WALKTHROUGH giving a FULL AND WORKING solution. It's HIGHLY advised to do the CTF before looking at this !
{: .prompt-danger }

# Setup

All right, first things first, let's connect to our VPN:

```bash
sudo openvpn [openvpn config file.ovpn]
```

Let's verify we are connected:

```
❯ ifconfig

[REDACTED]

tun0: flags=4305<UP,POINTOPOINT,RUNNING,NOARP,MULTICAST>  mtu 1500
        inet 10.14.***.***  netmask 255.255.128.0  destination 10.14.107.153
        inet6 fe80::b30f:eaaf:481d:11b7  prefixlen 64  scopeid 0x20<link>
        unspec 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  txqueuelen 500  (UNSPEC)
        RX packets 29774  bytes 5339960 (5.0 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 31428  bytes 2696499 (2.5 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
```

All right, we are connected, and we have our VPN IP.

Next, let's setup our "Hacking Setup".

I like to use tmux.

It's a really cool tool, and maybe some day i'll make a post on my tmux setup.

But for now, here is our setup:

![Hacking setup, yea !](/assets/img/posts/walkthrough/tryhackme/rootme/setup.png "Hacking setup, yea !")

Let's get started !

# Walkthrough

## Scanning

First of all, as always, let's nmap this

![Nmap the target](/assets/img/posts/walkthrough/tryhackme/rootme/nmap.png "Nmap the target")

All right, so we have a SSH server, and an HTTP one.

We can fuzz the web server, and try to find hidden directories:

> I'll use `feroxbuster`, but feel free to use any tool you like (I also like `ffuf` a lot)

![fuzz the web-server](/assets/img/posts/walkthrough/tryhackme/rootme/fuzzing.png "fuzz the web-server")

All right, we got two intresting directories, `/panel/` and `/uploads/` (Note: you should always explore every founding, but this time, these two are the only usefulls (; )

Okay, what's in `/panel/` ?

![panel directory](/assets/img/posts/walkthrough/tryhackme/rootme/panel.png "panel directory")

Hmm, and what's with `/uploads/` ?

![uploads directory](/assets/img/posts/walkthrough/tryhackme/rootme/uploads.png "uploads directory")

Hmmmmmm, could it be possible that files uploaded on `/panel/` are retreivable on `/uploads/` ?

![indeed we can upload](/assets/img/posts/walkthrough/tryhackme/rootme/we_can_upload.png "indeed we can up̂load")

> Okay, cool... And ?
{: .prompt-info }

As we saw by the nmap scan, as well as the `/uploads/` directory, we are against an apache server.

Apache runs PHP.

If we are able to upload a PHP file, we should be able to execute it !

Let's try to upload any .php shell:

![try to upload a php file](/assets/img/posts/walkthrough/tryhackme/rootme/fail_to_upload.png "try to upload a php file")

Arg, we can't upload php files.

> Okay, well, we'll try to search elsewhere...
{: .prompt-info }

Not so fast !

There are multiple ways to check if a file is PHP.

In this case, it's done through extension black-list.

This means that, if we find a file extension that apache execute as php, but is not black listed by the web-server, we should be able to upload our shell.

We can find a list of php extensions [here](https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html#file-upload-general-methodology).

After trying some, we can see that .phtml works !

![file uploaded !](/assets/img/posts/walkthrough/tryhackme/rootme/file_uploaded.png "file uploaded !")

After checking out the Bind/Reverse Shell blog, we make a PHP reverse shell.

After uploading and executing, we get our shell !

![we get a shell and upgrade it](/assets/img/posts/walkthrough/tryhackme/rootme/we_got_a_shell.png "we get a shell and upgrade it")

Okay, now onto the root.

We can confirm that we can't run anything with sudo, or that we just don't know the password:

![no sudo](/assets/img/posts/walkthrough/tryhackme/rootme/no_sudo.png "no sudo")

Well, in a more complicated CTF, i'd pop linpeas to automate the enumeration, but let's make it manually here.

Well, let's search for SUIDs:

```bash
find / -perm -4000 2>/dev/null
```

This will locate every executable that'll run as it's owner.

![suids](/assets/img/posts/walkthrough/tryhackme/rootme/suids.png "suids")

Well, well, well, what do we have here ?

> A lot of stuff lol
{: .prompt-info }

Yeah, that's right

We can use [GTFOBins](https://gtfobins.github.io/) to try and see what intresting SUID binary we have.

> After trying them all, none have any SUID vulnerability :(
{: .prompt-info }

Yea, because `python2.7` isn't present, but `python` is !

Let's see the `python`'s SUID payload:

![python gtfobins payload](/assets/img/posts/walkthrough/tryhackme/rootme/python_gtfobins_payload.png "python gtfobins payload")

Okay, let's try this !

Think to replace `./python` with `/usr/bin/python2.7` on the payload:

![become root on the box](/assets/img/posts/walkthrough/tryhackme/rootme/become_root.png "become root on the box")

Noice !

# Conclusion

That's one of the first room I did, and I still find it intresting, really easy and classic.

It's a good box !

Happy hacking <3 !
